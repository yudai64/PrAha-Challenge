### 論理削除とは何か？どのような解法があるのか？
- 論理削除とはそもそも何か？
  - 実際にレコードを消すのではなく、削除フラグのようなカラムの更新によって削除されたこととする。

- 物理削除とは？
  - DELETE文でレコードを消す

- なぜ、論理削除が生まれてくるのか？
  - SQLアンチパターン 幻の第26章「とりあえず削除フラグ」
  - 理由1: 心理的なハードルの高さ、怖さがある
  - 理由2: 削除したデータを検索対象に入れたい場合がある
  - 理由3: ログとしての用途
  - 理由4: 誤操作をすぐに戻したい

- アンチパターンとは何か？

- なぜ、論理削除はアンチパターンとして捉えられるのか？
  - 全てのSQL文のWHERE句に削除フラグが必ず入る
  - LIMIT 1などが蔓延していく
    - UNIQUE制約を貼れないことによりなぜか2レコード取れてしまったりなどしたときに場当たり的にLIMITを使用してしまう
- 論理削除に気づくきっかけは何か？
  - テーブル設計や、規約から気づく
- 論理削除というアンチパターンをどのように解いていくか？
  - 論理削除という概念は世の中にまずなく、お客様は論理削除という言葉を使っていない
    - 深掘りが足りていない可能性がある
    - システムには可視性の制御の概念がある
      - 認可、状態遷移
- 要件をどのように設計すればいいのか？
  - ORMの論理削除プラグインはあまり良くない
  - 状態遷移として捉える方法
    - Soft Delete と Hard Delete
    - Doctrine 2 “Behaviours” in a Nutshell
    - RDBにおけるStateパターンとは？
      - statusのようなカラムにvarcharで値を入れる
        - 最近だとENUMもある
      - UMLにある状態遷移図
    - Stateパターンが使えないケースはある？
      - 使えないケースはあまりない
      - FSM - Finite State Machine
      - State Machineのプラグインをまず探す
        - メリット
          - 状態遷移を宣言的にかけるようになる
          - 不正な状態遷移を防いでくれる
        - 状態遷移には向きが決まっていて、飛ばすことはできない
      - AASM - Ruby state machines
  - 履歴テーブルを使った設計による解法
    - 例えば現役のテーブルと削除済みのテーブルを作る
      - RDBのトリガー機能を使う
    - 履歴テーブルをあえて使う強いモチベーションは何か？
      - データの比率
        - 削除済みのレコードが増えていくとパフォーマンスが落ちる
  - そもそも削除も更新もしない解法もある
    - 現実世界で削除をするということはあまりない
    - 発生した事実に忠実にモデリングすると、情報の削除や更新をしない、改ざんになる
      - エンタープライズでは大事な考え
    - データ中心アプローチ（DOA) 椿さんとか佐藤さんとか渡辺さんとか
    - T字形ER手法(TM)
      - データ量が増えた場合にどうするか？
        - 金を積む
        - 確かにWebシステムが流行る前後のデータ量は違う
          - toC向けの方がデータ量は増えていくと考えられる
    - イミュータブルデータモデル(入門編)
- 誤った操作をなかったことにしたい、という課題はまだ解けていない
  - 教科書的なのは間違えにくいUI/画面設計を作る
    - 確認画面、ダイアログとか？
      - 確認しない人はしないよね。。でも少しは減らすことはできる
  - 遅延レプリケーションという解法